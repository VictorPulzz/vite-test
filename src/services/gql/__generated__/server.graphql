schema {
  query: Query
  mutation: Mutation
}

enum ContractChoice {
  full_time
  part_time
}

"""
Date (isoformat)
"""
scalar Date

type DepartmentType {
  id: Int!
  name: String!
}

enum GitPlatformEnum {
  BITBUCKET
  GITLAB
}

input IDInput {
  id: Int!
}

type ImageType {
  fileName: String!
  size: Int!
  url: String!
}

input LoginInput {
  email: String!
  password: String!
}

type LoginSuccessType {
  accessToken: String!
  refreshToken: String!
  user: UserType!
}

type MessageType {
  message: String!
}

type Mutation {
  """
  Login
  """
  login(data: LoginInput!): LoginSuccessType!
  """
  Project creation or updating by id
  """
  project(data: ProjectInput!): ProjectType!
  """
  Project deletion
  """
  projectDelete(data: IDInput!): MessageType!
  """
  User creation
  """
  signup(data: LoginInput!): MessageType!
  """
  Refreshing of tokens
  """
  tokenRefresh(data: RefreshTokenInput!): LoginSuccessType!
  """
  User deletion
  """
  userDelete: MessageType!
  """
  Add user note
  """
  userNote(data: NoteInput!): NoteType!
  """
  User updating
  """
  userUpdate(data: UserInput!): UserType!
}

input NoteInput {
  id: Int = null
  text: String!
  userId: Int!
}

type NoteType {
  createdBy: UserType
  id: Int!
  text: String!
}

input ProjectInput {
  awsLogsSlug: String = null
  gitGroupId: String = null
  gitPlatform: GitPlatformEnum = null
  gitSlug: String = null
  gitUrl: String = null
  id: Int = null
  name: String = null
  slackBuildsChannelId: String = null
  slackBuildsChannelUrl: String = null
  slackChannelId: String = null
  slackChannelUrl: String = null
  slackErrorsChannelId: String = null
  slackErrorsChannelUrl: String = null
  status: StatusEnum = null
}

type ProjectType {
  awsLogsSlug: String
  createdBy: UserType
  gitGroupId: String
  gitPlatform: GitPlatformEnum
  gitSlug: String
  gitUrl: String
  id: Int!
  name: String
  slackBuildsChannelId: String
  slackBuildsChannelUrl: String
  slackChannelId: String
  slackChannelUrl: String
  slackErrorsChannelId: String
  slackErrorsChannelUrl: String
  status: StatusEnum
}

type Query {
  """
  Getting list of users' departments
  """
  departmentsList: [DepartmentType!]!
  """
  Getting authenticated user
  """
  me: UserType!
  """
  Getting project by id
  """
  project(data: IDInput!): ProjectType!
  """
  Getting list of projects
  """
  projectsList: [ProjectType!]!
  """
  Getting list of users' roles
  """
  rolesList: [RoleType!]!
  """
  Getting list of users
  """
  usersList: [UserType!]!
}

input RefreshTokenInput {
  refreshToken: String!
}

type RoleType {
  id: Int!
  name: String!
}

enum StatusEnum {
  DESIGN
  FINISHED
  IN_PROGRESS
  ON_HOLD
  STOPPED
  SUPPORT
}

scalar Upload

input UserInput {
  address: String = null
  birthDate: Date = null
  contractType: ContractChoice = null
  department: IDInput = null
  email: String = null
  firstName: String = null
  isActive: Boolean = null
  isSuperuser: Boolean = null
  lastName: String = null
  photo: Upload
  role: IDInput = null
}

type UserType {
  address: String
  birthDate: Date
  contractType: ContractChoice
  department: DepartmentType
  email: String!
  firstName: String
  fullName: String!
  id: String!
  isActive: Boolean
  isSuperuser: Boolean
  lastName: String
  notes: [NoteType!]
  photo: ImageType
  role: RoleType
}
